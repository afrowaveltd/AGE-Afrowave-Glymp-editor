<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:AGE_Afrowave_Glyph_editor.ViewModels"
        xmlns:conv="using:AGE_Afrowave_Glyph_editor.Converters"
        x:DataType="vm:MainViewModel"
        Width="560"
        Height="600"
        MinWidth="560"
        MinHeight="600"
        MaxWidth="560"
        MaxHeight="600"
        CanResize="False"
        x:Class="AGE_Afrowave_Glyph_editor.MainView"
        Title="AGE - Afrowave Glyph Editor">
  <Window.Resources>
    <vm:MainViewModel x:Key="MainVM"/>
  </Window.Resources>
  <Window.DataContext>
    <StaticResource ResourceKey="MainVM"/>
  </Window.DataContext>

    <DockPanel Margin="10">

  <!-- Spodní bar -->
  <Border DockPanel.Dock="Bottom"
          Height="140"
          Background="#222"
          Padding="10"
          Margin="0,10,0,0">
    <StackPanel Spacing="8">
      <StackPanel Orientation="Horizontal" Spacing="8">
        <Button Content="Open"/>
        <Button Content="Save"/>
        <Button Content="Save As"/>
        <Button Content="New"/>
      </StackPanel>

      <!-- Preview řádek: zatím placeholder -->
      <Border Height="70" Background="#111" BorderBrush="#444" BorderThickness="1"/>
    </StackPanel>
  </Border>

  <!-- Hlavní editor -->
  <ScrollViewer HorizontalScrollBarVisibility="Auto"
                VerticalScrollBarVisibility="Auto">

    <StackPanel Spacing="6">

              <!-- Header řádek: sloupce 0..7 -->
              <StackPanel Orientation="Horizontal" Spacing="6">
          <Border Width="28"/>
          <ItemsControl ItemsSource="{Binding ColumnLabels}">
            <ItemsControl.ItemsPanel>
              <ItemsPanelTemplate>
                <UniformGrid Columns="{Binding Width}"/>
              </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
              <DataTemplate x:DataType="x:String">
                <Border Width="{Binding CellSize, Source={StaticResource MainVM}}"
                        Height="{Binding CellSize, Source={StaticResource MainVM}}">
                  <TextBlock Text="{Binding .}" Foreground="#888"
                             FontFamily="Consolas"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"/>
                </Border>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>

  <Border Width="90"/>
  <Border MinWidth="220"/>
</StackPanel>

      <!-- Řádky -->
      <ItemsControl ItemsSource="{Binding Rows}">
        <ItemsControl.ItemTemplate>
          <DataTemplate x:DataType="vm:RowViewModel">
            <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">

              <!-- Row label (A..P) -->
              <Border Width="28">
                <TextBlock Text="{Binding RowLabel}" Foreground="#88CCFF"
                           FontFamily="Consolas" VerticalAlignment="Center"/>
              </Border>

              <!-- Pixel strip -->
              <ItemsControl ItemsSource="{Binding Cells}"
                            Width="{Binding EditorWidth, Source={StaticResource MainVM}}"
                            HorizontalAlignment="Left">
                <ItemsControl.ItemsPanel>
                  <ItemsPanelTemplate>
                    <UniformGrid Columns="{Binding Width, Source={StaticResource MainVM}}"/>
                  </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                  <DataTemplate x:DataType="vm:PixelCellViewModel">
                    <Border Width="{Binding CellSize, Source={StaticResource MainVM}}"
                            Height="{Binding CellSize, Source={StaticResource MainVM}}"
                            BorderBrush="#555"
                            BorderThickness="1"
                            Background="{Binding IsOn, Converter={x:Static conv:BoolToBrushConverter.Instance}}"
                            PointerPressed="Pixel_PointerPressed"/>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>

              <!-- HEX box -->
              <Border Width="90" Height="{Binding CellSize, Source={StaticResource MainVM}}"
                      Background="#111"
                      BorderBrush="#335533" BorderThickness="1"
                      Padding="6,2">
                <TextBlock Text="{Binding HexText}"
                           Foreground="#55FF55"
                           FontFamily="Consolas"
                           VerticalAlignment="Center"/>
              </Border>

              <!-- BIN box -->
              <Border MinWidth="220" Height="{Binding CellSize, Source={StaticResource MainVM}}"
                      Background="#111"
                      BorderBrush="#665533" BorderThickness="1"
                      Padding="6,2">
                <TextBlock Text="{Binding BinText}"
                           Foreground="#FFDD55"
                           FontFamily="Consolas"
                           VerticalAlignment="Center"/>
              </Border>

            </StackPanel>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>

    </StackPanel>
  </ScrollViewer>

</DockPanel>
</Window>
